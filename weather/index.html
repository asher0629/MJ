<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>weather</title>
    <link rel="icon" href="images/favicon.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/weather-icons.min.css">
</head>
<body>
    <div id="weather_info">
        <div class="day">
        <h3 class="date"></h3>
        <h3 class="week"></h3>
        </div>
        <h1 class="city"></h1>
        <section>
            <i class="icon wi"></i>
            <p class="temp"></p>
            <p class="pop"></p>
            <div class="max_min">
                <!-- <p class="feels_like"></p> -->
                <p class="temp_min"></p>
                <p class="temp_max"></p>
                
                
            </div>
        </section>

        <div id="weekly_info">
            <p class="d-week"></p>
        </div>
        <!-- <img class="load_img" src="loading.gif" width="50"> -->
    </div>
    <div id="weekly_info">
            
    </div>

    <script>
        url = 'https://api.openweathermap.org/data/2.5/onecall?id=1842936&lat=37.623611&lon=126.714172&exclude=minutely&appid=28981aff47d330d87837128734f55567';
         $('weather_info .load_img').show();
            $.getJSON(url, function(data) {
                var  Now = new Date(),
                    StrNow = String(Now),
                    nowYear = String(Now.getFullYear()),
                    nowMon = String(Now.getMonth()+1),
                    nowDay = String(Now.getDate());
                    if(nowMon.length == 1) {
                    nowMon = "0"+nowMon
                    }
                var NowToday = nowMon+'.'+nowDay;
                var week = new Array('일','월','화','수','목','금','토');
                var month = new Array('')
                
                    

                var timezone = data.timezone;       // 도시명
                var city = timezone.replace('Asia/Seoul','Gimpo');
                var current = data.current;        //
                var ctemp = data.current.temp;
                var feel = current.feels_like;
                var c_weather = current.weather[0].main;
                var c_icon = current.weather[0].id;
                var c_dscript = current.weather[0].description;
                var daily = data.daily;
                var dtemp = daily.temp;
                var temp_min = daily[Now.getDay()].temp.min;
                var temp_max = daily[Now.getDay()].temp.max;
                var rain = daily[Now.getDay()].rain;
                var dew_point = daily[Now.getDay()].dew_point;
                var pop = daily[Now.getDay()].pop;


                var nowTimestamp = Math.floor(Date.now() / 1000);
                var weatherClass = 'wi wi-owm-';
                // weatherClass += (nowTimestamp >= data.sunrise && nowTimestamp <= data.sunset ? 'night' : 'day');
                weatherClass += (current.weather[0].id);

                $("#weather_info .icon").addClass(weatherClass);
                $('#weather_info .date').html(NowToday);
                $('#weather_info .week').html(week[Now.getDay()]+'요일');

                $('#weather_info>.city').html(city);
                $('#weather_info .w_id').html(c_dscript);
                $('#weather_info .temp_min').html(parseInt(temp_min-273.15)+'&deg;' + 'min');
                $('#weather_info .temp_max').html(parseInt(temp_max-273.15)+'&deg;' + 'max');
                $('#weather_info .temp').html(parseInt(ctemp-273.15)+'&deg;');
                $('#weather_info .feels_like').html('체감 온도 : ' + parseInt(feel-273.15)+'&deg;');
                $('#weather_info .pop').html('강수확률 : ' + parseInt(pop*100) + '%');
                $('#weather_info .load_img').hide();

            })
            .fail(function(){
                alert("loading error");
            });

    </script>
</body>
</html>